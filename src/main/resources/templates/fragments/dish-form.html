<form
    th:object="${dish}"
    th:action="${dish.id == null}
        ? @{/dishes}
        : @{/dishes/{id}(id=${dish.id})}"
    method="post"
>
    <div class="mb-3">
        <label class="form-label fw-semibold">Tên món</label>
        <input
            type="text"
            class="form-control form-control-lg"
            th:field="*{dishName}"
            placeholder="Ví dụ: Thịt kho tiêu"
            required
        />
    </div>

    <!-- Chọn loại có sẵn -->
    <div class="mb-3">
        <label class="form-label fw-semibold">Chọn loại món</label>
        <select id="dishTypeSelect" class="form-select form-select-lg mb-2" th:field="*{dishType}" required>
            <option value="">-- Chọn loại có sẵn --</option>
            <option th:each="type : ${dishTypes}" th:value="${type.id}" th:text="${type.label}"></option>
        </select>
        <button type="button" class="btn btn-outline-primary btn-sm" onclick="toggleNewDishType()">
            Không có loại nào để chọn?
        </button>
    </div>

    <!-- Nhập loại mới (ẩn mặc định) -->
    <div class="mb-3 d-none" id="newDishTypeBox">
        <label class="form-label fw-semibold">Thêm loại mới</label>

        <div class="d-flex gap-2">
            <input
                type="text"
                id="newDishTypeInput"
                class="form-control form-control-lg"
                placeholder="Ví dụ: Món xào"
            />

            <button type="button" class="btn btn-success" onclick="addDishType()">Thêm</button>
        </div>

        <div class="form-text text-muted">Loại món sẽ được thêm và tự động chọn</div>
    </div>

    <div class="form-check form-switch mb-4">
        <input class="form-check-input" type="checkbox" th:field="*{hasEaten}" />
        <label class="form-check-label fw-semibold">Đã ăn rồi</label>
    </div>

    <div class="d-flex justify-content-end gap-2">
        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Huỷ</button>

        <button
            type="submit"
            class="btn"
            th:classappend="${dish.id == null ? 'btn-primary' : 'btn-success'}"
            th:text="${dish.id == null ? 'Thêm mới' : 'Cập nhật'}"
        ></button>
    </div>
</form>
